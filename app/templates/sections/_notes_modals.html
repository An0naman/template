{# Notes Section Modals for Entry v2 #}

{# Image Viewer Modal with Carousel/Gallery Support #}
<div class="modal fade" id="imageViewerModal" tabindex="-1" aria-labelledby="imageViewerModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="imageViewerModalLabel">
                    <i class="fas fa-image me-2"></i>Image Viewer <span id="imageCounter" class="text-muted small"></span>
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-center position-relative" style="background-color: #f8f9fa; min-height: 400px; display: flex; align-items: center; justify-content: center;">
                {# Previous Button #}
                <button type="button" class="btn btn-lg btn-dark position-absolute start-0 top-50 translate-middle-y ms-3" id="imagePrevBtn" style="z-index: 10; opacity: 0.7; display: none;" title="Previous image (← arrow key)">
                    <i class="fas fa-chevron-left"></i>
                </button>
                
                {# Image #}
                <img id="imageViewerImg" src="" alt="Image preview" style="max-width: 100%; max-height: 70vh; border-radius: 4px; box-shadow: 0 2px 8px rgba(0,0,0,0.2);">
                
                {# Next Button #}
                <button type="button" class="btn btn-lg btn-dark position-absolute end-0 top-50 translate-middle-y me-3" id="imageNextBtn" style="z-index: 10; opacity: 0.7; display: none;" title="Next image (→ arrow key)">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            <div class="modal-footer">
                <p class="mb-0 text-muted small" id="imageViewerTitle"></p>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

{# Note Detail Modal #}
<div class="modal fade" id="noteDetailModal" tabindex="-1" aria-labelledby="noteDetailModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="noteDetailModalLabel">Note Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                {# Note Metadata #}
                <div class="mb-3">
                    <p><strong>Title:</strong> <span id="modalNoteTitle"></span></p>
                    <p><strong>Type:</strong> <span id="modalNoteType"></span></p>
                    <p><strong>Created:</strong> <span id="modalNoteCreated"></span></p>
                </div>
                
                {# Note Relationships (if associated with other entries) #}
                <div id="modalNoteRelationships" style="display: none;">
                    <div class="alert alert-info">
                        <div class="d-flex align-items-center mb-2">
                            <h6 class="mb-0">
                                <i class="fas fa-sitemap me-2"></i>Associated Entries
                            </h6>
                            <span id="modalRelationshipType" class="badge bg-info ms-2"></span>
                        </div>
                        <div id="modalRelationshipDetails">
                            {# Dynamic relationship details #}
                        </div>
                    </div>
                </div>
                
                {# Reminder Information #}
                <div id="modalNoteReminder" style="display: none;">
                    <div class="reminder-status-card mb-3 p-3 border rounded">
                        <div id="reminderDisplayMode">
                            <div class="d-flex align-items-center justify-content-between mb-2">
                                <h6 class="mb-0">
                                    <i class="fas fa-bell me-2"></i>Reminder
                                </h6>
                                <span id="modalReminderStatus" class="badge"></span>
                            </div>
                            <div class="reminder-details">
                                <div class="row">
                                    <div class="col-md-6">
                                        <small class="text-muted">Scheduled for:</small>
                                        <div id="modalReminderDate" class="fw-bold"></div>
                                    </div>
                                    <div class="col-md-6 text-end">
                                        <button type="button" class="btn btn-sm btn-outline-primary" id="editReminderBtn">
                                            <i class="fas fa-edit me-1"></i>Edit
                                        </button>
                                    </div>
                                </div>
                                <div id="reminderProgress" class="mt-2">
                                    {# Dynamic progress info #}
                                </div>
                            </div>
                        </div>
                        
                        {# Edit Reminder Form #}
                        <div id="reminderEditMode" style="display: none;">
                            <div class="mb-3">
                                <label for="editReminderDateTime" class="form-label">Reminder Date & Time:</label>
                                <input type="datetime-local" class="form-control" id="editReminderDateTime">
                            </div>
                            <div class="d-flex gap-2">
                                <button type="button" class="btn btn-sm btn-success" id="saveReminderBtn">
                                    <i class="fas fa-save me-1"></i>Save
                                </button>
                                <button type="button" class="btn btn-sm btn-secondary" id="cancelReminderEditBtn">
                                    Cancel
                                </button>
                                <button type="button" class="btn btn-sm btn-danger" id="deleteReminderBtn">
                                    <i class="fas fa-trash me-1"></i>Remove
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                {# Note Content #}
                <h6>Content:</h6>
                <div id="noteContentDisplay">
                    <div id="modalNoteContent" class="mb-3" style="white-space: pre-wrap;"></div>
                    
                    {# URL Bookmarks Display #}
                    <div id="modalBookmarksDisplay" style="display: none;">
                        <h6 class="mt-3">URL Bookmarks:</h6>
                        <div id="modalBookmarksList" class="list-group list-group-flush mb-3">
                            {# Bookmarks will be populated here #}
                        </div>
                    </div>
                    
                    <button type="button" class="btn btn-sm btn-primary" id="editNoteContentBtn">
                        <i class="fas fa-edit me-1"></i>Edit Note
                    </button>
                </div>
                
                {# Edit Note Form #}
                <div id="noteContentEditMode" style="display: none;">
                    <div class="mb-3">
                        <label for="editNoteTitle" class="form-label">Title:</label>
                        <input type="text" class="form-control" id="editNoteTitle">
                    </div>
                    <div class="mb-3">
                        <label for="editNoteText" class="form-label">Content:</label>
                        <textarea class="form-control" id="editNoteText" rows="5"></textarea>
                    </div>
                    
                    {# URL Bookmarks Edit #}
                    <div class="mb-3">
                        <label class="form-label">URL Bookmarks:</label>
                        <div id="editUrlBookmarksContainer">
                            <div id="editUrlBookmarksList">
                                {# Dynamic bookmark fields #}
                            </div>
                            <button type="button" class="btn btn-sm btn-outline-secondary mt-2" id="editAddBookmarkBtn">
                                <i class="fas fa-plus me-1"></i>Add Bookmark
                            </button>
                        </div>
                    </div>
                    
                    <div class="d-flex gap-2">
                        <button type="button" class="btn btn-sm btn-success" id="saveNoteContentBtn">
                            <i class="fas fa-save me-1"></i>Save Changes
                        </button>
                        <button type="button" class="btn btn-sm btn-secondary" id="cancelNoteContentEditBtn">
                            Cancel
                        </button>
                    </div>
                </div>
                
                <hr>
                
                {# Attachments Section #}
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h6 class="mb-0">Attached Files:</h6>
                    <button type="button" class="btn btn-sm btn-success" id="addAttachmentsBtn">
                        <i class="fas fa-paperclip me-1"></i>Add Files
                    </button>
                </div>
                
                {# Add Attachments Form #}
                <div id="addAttachmentsForm" style="display: none;" class="mb-3">
                    <div class="mb-3">
                        <label for="additionalFiles" class="form-label">Select files:</label>
                        <input type="file" class="form-control" id="additionalFiles" multiple>
                        <div class="form-text">Maximum file size: {{ max_file_size }}MB per file</div>
                    </div>
                    <div class="d-flex gap-2">
                        <button type="button" class="btn btn-sm btn-success" id="uploadAdditionalFilesBtn">
                            <i class="fas fa-upload me-1"></i>Upload
                        </button>
                        <button type="button" class="btn btn-sm btn-secondary" id="cancelAddAttachmentsBtn">
                            Cancel
                        </button>
                    </div>
                </div>
                
                <div id="modalNoteFiles" class="row row-cols-1 row-cols-md-2 g-2">
                    <div class="col" id="noAttachmentsPlaceholder">
                        <div class="text-center text-muted py-4">
                            <p>No files attached.</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-danger" id="deleteNoteFromModalBtn">
                    <i class="fas fa-trash-alt me-1"></i>Delete Note
                </button>
            </div>
        </div>
    </div>
</div>
